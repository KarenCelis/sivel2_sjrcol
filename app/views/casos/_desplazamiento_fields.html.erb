<% #encoding: UTF-8 %>
<div class='control-group nested-fields'>
  <div class="controls">
    <%= f.input :id, as: :hidden %>
    <%= f.input :fechaexpulsion, 
      :input_html => { "data-behaviour" => "datepicker",
        value: f.object.fechaexpulsion || @caso.fecha },
        :as => :string
    %>
    <%= f.association :expulsion,
        collection: Ubicacion.where(:id_caso => @caso.id),
        label_method: lambda {|t| Pais.find(t.id_pais).nombre + 
          (t.id_departamento.nil? ? "" : " / " + 
             Departamento.where(id: t.id_departamento,
               id_pais: t.id_pais).take.nombre) },
               value_method: :id 
    %>
    <%= f.input :fechallegada, 
          :input_html => { "data-behaviour" => "datepicker" },
          :as => :string
    %>
    <%= f.association :llegada,
          collection: Ubicacion.where(:id_caso => @caso.id),
          label_method: lambda {|t| Pais.find(t.id_pais).nombre + 
            (t.id_departamento.nil? ? "" : " / " + 
             Departamento.where(id: t.id_departamento,
            id_pais: t.id_pais).take.nombre) },
          value_method: :id 
    %>
    <%= f.association :clasifdesp,
          collection: Clasifdesp.where(fechadeshabilitacion: nil),
          label_method: :nombre,
          value_method: :id 
    %>
    <%= f.association :tipodesp,
          collection: Tipodesp.where(fechadeshabilitacion: nil),
          label_method: :nombre,
          value_method: :id 
    %>
    <%= f.input :descripcion, as: :text %>
    <%= f.input :otrosdatos, as: :text %>
    <%= f.input :declaro, collection: [["SI", :S], 
      ["NO", :N], ["NO SABE / NO RESPONDE", :R]], 
      include_blank: false 
    %>
    <%= f.input :hechosdeclarados, as: :text %>
    <%= f.input :fechadeclaracion, 
          :input_html => { "data-behaviour" => "datepicker" },
          :as => :string
    %>
    <%= f.association :declaroante,
          collection: Declaroante.where(fechadeshabilitacion: nil),
          label_method: :nombre,
          value_method: :id 
    %>
    <%= f.association :inclusion,
          collection: Inclusion.where(fechadeshabilitacion: nil),
          label_method: :nombre,
          value_method: :id 
    %>
    <%= f.association :acreditacion,
          collection: Acreditacion.where(fechadeshabilitacion: nil),
          label_method: :nombre,
          value_method: :id 
    %>
    <%= f.input :retornado, 
      wrapper_html: { class: "span11 offset1" }  
    %>
    <%= f.input :reubicado, 
      wrapper_html: { class: "span11 offset1" }  
    %>
    <%= f.input :connacionalretorno, 
      wrapper_html: { class: "span11 offset1" }  
    %>
    <%= f.input :acompestado, 
      wrapper_html: { class: "span11 offset1" }  
    %>
    <%= f.input :connacionaldeportado, 
      wrapper_html: { class: "span11 offset1" }  
    %>
    <%= f.input :oficioantes %>
    <%= f.association :modalidadtierra,
      collection: Modalidadtierra .where(fechadeshabilitacion: nil),
      label_method: :nombre,
      value_method: :id 
    %>
    <%= f.input :materialesperdidos, as: :text %>
    <%= f.input :inmaterialesperdidos, as: :text %>
    <%= f.input :protegiorupta, 
      wrapper_html: { class: "span11 offset1" }  
    %>
    <%= f.input :documentostierra, as: :text %>

    <%= link_to_remove_association "Eliminar Desplazamiento", f, 
      {:class => 'btn-danger', :'data-existing' => 'true'} 
    %>
  </div>
</div>
